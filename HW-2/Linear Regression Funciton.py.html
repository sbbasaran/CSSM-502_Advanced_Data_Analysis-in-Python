#!/usr/bin/env python
# coding: utf-8

# In[1]:


import numpy as np
import pandas as pd


# In[2]:


X = np.array([[1, 1], [1, 2], [2, 2], [2, 3]])
y = np.dot(X, np.array([1, 2])) + 3
y = y + np.random.normal(0, 0.01, len(y))
y


# In[3]:


from sklearn.linear_model import LinearRegression
reg = LinearRegression().fit(X, y)
reg.coef_, reg.intercept_


# In[4]:


# Our method to estimate beta

X = np.concatenate((X, np.ones((len(X), 1))), axis=1)

# X'X
X_prime_X = np.matmul(X.T, X)
# inv(X'X)
inv_X_prime_X = np.linalg.inv(X_prime_X)
# X'y
X_prime_y = np.matmul(X.T, y)
# beta = (inv(X'X))X'y
beta = np.matmul(inv_X_prime_X, X_prime_y)
beta


# In[5]:


# Our method to estimate variance of beta (k is assumed to be 0 here)

y_hat = np.matmul(X, beta)
e = y - y_hat
sigma_2 = np.matmul(e.T, e)/(len(y) - 1)
var_beta = sigma_2*inv_X_prime_X
var_beta


# In[ ]:




